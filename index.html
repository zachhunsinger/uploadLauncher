<!DOCTYPE html>
<html>
  <head>
    <title>Launch Upload App</title>
    <script>
      const appUrl = "https://apps.powerapps.com/play/appId=8e7e0962-7fd3-4f3f-b1bb-2d20d07db53e&tenantId=28e7d186-bd09-4557-b590-64e92c1c14b8";

      function launchApp() {
        const win = window.open(
          appUrl,
          "UploadPDFApp",
          "width=300,height=225,top=0,left=0,resizable=no"
        );

        if (win) {
          const attemptHideHeader = () => {
            try {
              const header = win.document.getElementById("shellHeaderContainer");
              if (header) {
                header.style.display = "none";
                console.log("ðŸ’£ Purple bar annihilated.");
              } else {
                setTimeout(attemptHideHeader, 200); // Try again until it's ready
              }
            } catch (err) {
              // Cross-origin policy may block this
              console.warn("ðŸš« Can't access window DOM directly (cross-origin)");
            }
          };

          setTimeout(attemptHideHeader, 1000);
          setTimeout(() => window.close(), 500);
        }
      }

      window.onload = () => {
        setTimeout(() => launchApp(), 300);
      };
    </script>
  </head>
  <body style="font-family:Segoe UI; text-align:center; padding-top:100px;">
    <h2>Launching the upload tool...</h2>
    <p>If your popup was blocked, <strong>click below to launch manually:</strong></p>
    <button onclick="launchApp()" style="padding: 12px 24px; font-size: 18px; border-radius: 8px; cursor: pointer;">
      ðŸš€ Launch Upload App
    </button>
  </body>
</html>
